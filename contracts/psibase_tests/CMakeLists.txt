function(contract name)
    add_executable(${name} ${ARGN})
    target_include_directories(${name} PUBLIC include)
    target_link_libraries(${name} psibase-contract-simple-malloc)
    set_target_properties(${name} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${ROOT_BINARY_DIR})
endfunction()

function(add suffix)
    contract(test-cntr${suffix} test-cntr.cpp)
    contract(boot${suffix} boot.cpp)
    contract(token${suffix} token.cpp)
    contract(rpc${suffix} rpc.cpp)
    contract(account${suffix} account.cpp)
    contract(test_kv${suffix} test_kv.cpp)

    add_executable(tests${suffix} test.cpp)
    target_include_directories(tests${suffix} PUBLIC include)
    target_link_libraries(tests${suffix} nctestlib)
    set_target_properties(tests${suffix} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${ROOT_BINARY_DIR})
endfunction(add)

add("")
add("-debug")
